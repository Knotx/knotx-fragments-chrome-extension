<!--
  Copyright (C) 2019 Knot.x Project

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Knot.x Functional Test: Payments</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="http://cognifide.com/favicon.ico?v=2"/>
  <link href="https://bootswatch.com/4/simplex/bootstrap.min.css" rel="stylesheet"/>
</head>
<body>
<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <div class="jumbotron">
        <h2>
          Hello Knot.x - a reactive integration framework!
        </h2>
        <p>
          This page combines dynamic data with a template. A template may consist of many
          independent
          fragments defining the data they require. Dynamic data may come from external web APIs,
          databases etc.
        </p>
        <p>
          <a class="btn btn-primary btn-large"
             href="https://github.com/Knotx/knotx">Learn more</a>
        </p>
      </div>
    </div>
  </div>
  <div class="row" style="margin-left: 10px">
    <!-- data-knotx-id="d5e81e1b-5a2e-4503-b846-e7848fc176bc" --><script data-knotx-id="d5e81e1b-5a2e-4503-b846-e7848fc176bc" type="application/json">{"finishTime":1582806545315,"fragment":{"id":"d5e81e1b-5a2e-4503-b846-e7848fc176bc","type":"snippet","configuration":{"data-knotx-task":"user-task"},"body":"\n      <div>\n        <h2>User details</h2>\n        <p>Id: 3214232</p>\n        <p>Name: Redford</p>\n        <p>Surname: Cornborough</p>\n        <p>Email: rcornborough0@theatlantic.com</p>\n      </div>\n    ","payload":{"fetch-user-info":{"_request":{"type":"HTTP","source":"/service/mock/userInfo.json","metadata":{"headers":{}}},"_response":{"success":true,"metadata":{"statusCode":"200","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]}}},"_result":{"id":3214232,"first_name":"Redford","last_name":"Cornborough","email":"rcornborough0@theatlantic.com","gender":"Male","credit_card_type":"visa","credit_card_number":"3562444175055197","user_group":"premium"}}}},"graph":{"id":"7357cb5c-090b-4141-93bd-a49927bb94fa","type":"SINGLE","label":"fetch-user-info","subtasks":[],"operation":{"data":{"alias":"fetch-user-info","actionFactory":"http","actionConfig":{"config":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/userInfo.json","port":53976},"logLevel":"info"},"factory":"http"}},"factory":"action"},"on":{"_success":{"id":"7774be63-a101-4aca-ac4c-1db7254b5f3f","type":"SINGLE","label":"te-hbs","subtasks":[],"operation":{"data":{"alias":"te-hbs","actionFactory":"knot","actionConfig":{"config":{"address":"knotx.knot.te.handlebars","deliveryOptions":{"sendTimeout":3000},"logLevel":"info"},"factory":"knot"}},"factory":"action"},"on":{},"_metadataStatus":"ok","status":"SUCCESS","response":{"transition":"_success","invocations":[]},"_logStatus":"ok"}},"_metadataStatus":"ok","status":"SUCCESS","response":{"transition":"_success","invocations":[{"alias":"fetch-user-info","logs":{"request":{"path":"/service/mock/userInfo.json","requestHeaders":{}},"response":{"httpVersion":"HTTP_1_1","statusCode":"200","statusMessage":"OK","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:53976/service/mock/userInfo.json"},"responseBody":"{\n  \"id\": 3214232,\n  \"first_name\": \"Redford\",\n  \"last_name\": \"Cornborough\",\n  \"email\": \"rcornborough0@theatlantic.com\",\n  \"gender\": \"Male\",\n  \"credit_card_type\": \"visa\",\n  \"credit_card_number\": \"3562444175055197\",\n  \"user_group\": \"premium\"\n}"},"doActionLogs":[]}]},"_logStatus":"ok"},"startTime":1582806545157,"status":"SUCCESS"}</script>
    <div>
      <h2>User details</h2>
      <p>Id: 3214232</p>
      <p>Name: Redford</p>
      <p>Surname: Cornborough</p>
      <p>Email: rcornborough0@theatlantic.com</p>
    </div>
    <!-- data-knotx-id="d5e81e1b-5a2e-4503-b846-e7848fc176bc" -->
  </div>
  <div class="row">
    <div class="row" style="margin-left: 10px">
      <!-- data-knotx-id="c19f4c38-00e8-44f0-a014-39f88ef3afd7" --><script data-knotx-id="c19f4c38-00e8-44f0-a014-39f88ef3afd7" type="application/json">{"finishTime":1582806545418,"fragment":{"id":"c19f4c38-00e8-44f0-a014-39f88ef3afd7","type":"snippet","configuration":{"data-knotx-task":"payments-task"},"body":"\n        <div>\n          <h2>Payment providers</h2>\n          <ul>\n                        <li>\n              <p>Payment provider: PayPal premium</p>\n              <p>Payment URL: https://paypal-example.com/payment?id=1983247919hv9sa398f</p>\n            </li>\n                        <li>\n              <p>Payment provider: PayU</p>\n              <p>Payment URL: https://payu-example.com/tr?id=afj08aw398gha0we9ge</p>\n            </li>\n                        <li>\n              <p>Payment provider: Credit Card</p>\n              <p>Payment URL: https://cc-example.com/pay/19g8esry9se8rgyse90r8ug4</p>\n            </li>\n                      </ul>\n        </div>\n      ","payload":{"fetch-user-info":{"_request":{"type":"HTTP","source":"/service/mock/userInfo.json","metadata":{"headers":{}}},"_response":{"success":true,"metadata":{"statusCode":"200","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]}}},"_result":{"id":3214232,"first_name":"Redford","last_name":"Cornborough","email":"rcornborough0@theatlantic.com","gender":"Male","credit_card_type":"visa","credit_card_number":"3562444175055197","user_group":"premium"}},"fetch-payment-providers":{"_request":{"type":"HTTP","source":"/service/mock/paymentProviders.json","metadata":{"headers":{}}},"_response":{"success":true,"metadata":{"statusCode":"200","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]}}},"_result":[{"verified":true,"paymentUrl":"https://paypal-example.com/payment?id=1983247919hv9sa398f","name":"PayPal premium"},{"verified":true,"paymentUrl":"https://payu-example.com/tr?id=afj08aw398gha0we9ge","name":"PayU"},{"verified":true,"paymentUrl":"https://cc-example.com/pay/19g8esry9se8rgyse90r8ug4","name":"Credit Card"}]},"fetch-offers":{"_result":{"fallback":"json-syntax-error"}},"fetch-delivery":{"_result":{"fallback":"action ended with _timeout"}}}},"graph":{"id":"72d46595-9796-4eaf-b2a6-91e7c8217032","type":"SINGLE","label":"fetch-user-info","subtasks":[],"operation":{"data":{"alias":"fetch-user-info","actionFactory":"http","actionConfig":{"config":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/userInfo.json","port":53976},"logLevel":"info"},"factory":"http"}},"factory":"action"},"on":{"_success":{"id":"b786af91-16f8-44b8-86d7-7bdcb3e73918","type":"COMPOSITE","label":"composite","subtasks":[{"id":"0adf7191-db35-48f2-86f4-833fc5be1bc8","type":"SINGLE","label":"fetch-payment-providers","subtasks":[],"operation":{"data":{"alias":"fetch-payment-providers","actionFactory":"http","actionConfig":{"config":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/paymentProviders.json","port":53976},"logLevel":"info"},"factory":"http"}},"factory":"action"},"on":{"_error":{"id":"3f6a8593-de99-47bf-85bb-6747d6dd103f","type":"SINGLE","label":"fetch-payment-providers-fallback","subtasks":[],"operation":{"data":{"alias":"fetch-payment-providers-fallback","actionFactory":"http","actionConfig":{"config":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":53976},"logLevel":"info"},"factory":"http"}},"factory":"action"},"on":{},"_metadataStatus":"ok","_logStatus":"missing","status":"UNPROCESSED"}},"_metadataStatus":"ok","status":"SUCCESS","response":{"transition":"_success","invocations":[{"alias":"fetch-payment-providers","logs":{"request":{"path":"/service/mock/paymentProviders.json","requestHeaders":{}},"response":{"httpVersion":"HTTP_1_1","statusCode":"200","statusMessage":"OK","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:53976/service/mock/paymentProviders.json"},"responseBody":"[\n  {\n    \"verified\": true,\n    \"paymentUrl\": \"https://paypal-example.com/payment?id=1983247919hv9sa398f\",\n    \"name\": \"PayPal premium\"\n  },\n  {\n    \"verified\": true,\n    \"paymentUrl\": \"https://payu-example.com/tr?id=afj08aw398gha0we9ge\",\n    \"name\": \"PayU\"\n  },\n  {\n    \"verified\": true,\n    \"paymentUrl\": \"https://cc-example.com/pay/19g8esry9se8rgyse90r8ug4\",\n    \"name\": \"Credit Card\"\n  }\n]"},"doActionLogs":[]}]},"_logStatus":"ok"},{"id":"8470a4cb-3d37-4fb4-ac26-3d912296bc4a","type":"SINGLE","label":"fetch-offers","subtasks":[],"operation":{"data":{"alias":"fetch-offers","actionFactory":"http","actionConfig":{"config":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/specialOffers.xml","port":53976},"responseOptions":{"forceJson":true,"predicates":[]},"logLevel":"info"},"factory":"http"}},"factory":"action"},"on":{"_error":{"id":"12613cb7-4c73-4ff6-a7f9-529e77b875bd","type":"SINGLE","label":"fetch-offers-fallback","subtasks":[],"operation":{"data":{"alias":"fetch-offers-fallback","actionFactory":"inline-payload","actionConfig":{"config":{"alias":"fetch-offers","payload":{"_result":{"fallback":"json-syntax-error"}},"logLevel":"info"},"factory":"inline-payload"}},"factory":"action"},"on":{},"_metadataStatus":"ok","status":"SUCCESS","response":{"transition":"_success","invocations":[{"alias":"fetch-offers-fallback","logs":{"key":"fetch-offers","value":{"_result":{"fallback":"json-syntax-error"}}},"doActionLogs":[]}]},"_logStatus":"ok"}},"_metadataStatus":"ok","status":"SUCCESS","response":{"transition":"_error","invocations":[{"alias":"fetch-offers","logs":{"request":{"path":"/service/mock/specialOffers.xml","requestHeaders":{}},"response":{"httpVersion":"HTTP_1_1","statusCode":"500","statusMessage":"Server Error","headers":{"Content-Type":["text/html; charset=ISO-8859-1"],"Cache-Control":["must-revalidate,no-cache,no-store"],"Content-Length":["2606"],"Connection":["close"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:53976/service/mock/specialOffers.xml"},"errors":[{"className":"java.io.IOException","message":"The service responded with unsuccessful status code: 500"}]},"doActionLogs":[]}]},"_logStatus":"ok"},{"id":"d5b18804-e68d-4072-a0db-6765c84d46b9","type":"SINGLE","label":"fetch-delivery-options-cb","subtasks":[],"operation":{"data":{"alias":"fetch-delivery-options-cb","actionFactory":"cb","actionConfig":{"config":{"circuitBreakerName":"delivery-cb","circuitBreakerOptions":{"maxRetries":1,"timeout":50},"logLevel":"info"},"doAction":"fetch-delivery","factory":"cb"}},"factory":"action"},"on":{"_fallback":{"id":"d4978b25-a0e3-4172-8161-3f7088936a8e","type":"SINGLE","label":"fetch-delivery-timeout","subtasks":[],"operation":{"data":{"alias":"fetch-delivery-timeout","actionFactory":"inline-payload","actionConfig":{"config":{"alias":"fetch-delivery","payload":{"_result":{"fallback":"action ended with _timeout"}},"logLevel":"info"},"factory":"inline-payload"}},"factory":"action"},"on":{},"_metadataStatus":"ok","status":"SUCCESS","response":{"transition":"_success","invocations":[{"alias":"fetch-delivery-timeout","logs":{"key":"fetch-delivery","value":{"_result":{"fallback":"action ended with _timeout"}}},"doActionLogs":[]}]},"_logStatus":"ok"}},"_metadataStatus":"ok","status":"SUCCESS","response":{"transition":"_fallback","invocations":[{"alias":"fetch-delivery-options-cb","logs":{"invocationCount":"2","error":"Exception: class io.vertx.circuitbreaker.TimeoutException. operation timeout"},"doActionLogs":[]}]},"_logStatus":"ok"}],"operation":{"factory":"subtasks"},"on":{"_success":{"id":"06ed683d-6388-421c-825e-d6bc7bd14b77","type":"SINGLE","label":"te-pebble","subtasks":[],"operation":{"data":{"alias":"te-pebble","actionFactory":"knot","actionConfig":{"config":{"address":"knotx.knot.te.pebble","deliveryOptions":{"sendTimeout":3000},"logLevel":"info"},"factory":"knot"}},"factory":"action"},"on":{},"_metadataStatus":"ok","status":"SUCCESS","response":{"transition":"_success","invocations":[]},"_logStatus":"ok"}},"_metadataStatus":"ok","status":"SUCCESS","response":{"transition":"_success","invocations":[]},"_logStatus":"ok"},"_custom":{"id":"af7a99f7-4f52-47f2-b8dc-f00ad94f59b1","type":"SINGLE","label":"fetch-user-info-custom-fallback","subtasks":[],"operation":{"data":{"alias":"fetch-user-info-custom-fallback","actionFactory":"http","actionConfig":{"config":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":53976},"logLevel":"info"},"factory":"http"}},"factory":"action"},"on":{},"_metadataStatus":"ok","_logStatus":"missing","status":"UNPROCESSED"},"_error":{"id":"07f71ff4-8f69-449e-9b86-f11041ed0054","type":"SINGLE","label":"fetch-user-info-fallback","subtasks":[],"operation":{"data":{"alias":"fetch-user-info-fallback","actionFactory":"http","actionConfig":{"config":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":53976},"logLevel":"info"},"factory":"http"}},"factory":"action"},"on":{"_success":{"id":"5af456ee-f930-4ff9-8f7a-5ab2daab2e07","type":"SINGLE","label":"fetch-user-info-fallback-success","subtasks":[],"operation":{"data":{"alias":"fetch-user-info-fallback-success","actionFactory":"http","actionConfig":{"config":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":53976},"logLevel":"info"},"factory":"http"}},"factory":"action"},"on":{},"_metadataStatus":"ok","_logStatus":"missing","status":"UNPROCESSED"},"_error":{"id":"12b27d4c-0760-472d-af00-14656fed386e","type":"SINGLE","label":"fetch-user-info-fallback-error","subtasks":[],"operation":{"data":{"alias":"fetch-user-info-fallback-error","actionFactory":"http","actionConfig":{"config":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":53976},"logLevel":"info"},"factory":"http"}},"factory":"action"},"on":{},"_metadataStatus":"ok","_logStatus":"missing","status":"UNPROCESSED"}},"_metadataStatus":"ok","_logStatus":"missing","status":"UNPROCESSED"}},"_metadataStatus":"ok","status":"SUCCESS","response":{"transition":"_success","invocations":[{"alias":"fetch-user-info","logs":{"request":{"path":"/service/mock/userInfo.json","requestHeaders":{}},"response":{"httpVersion":"HTTP_1_1","statusCode":"200","statusMessage":"OK","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:53976/service/mock/userInfo.json"},"responseBody":"{\n  \"id\": 3214232,\n  \"first_name\": \"Redford\",\n  \"last_name\": \"Cornborough\",\n  \"email\": \"rcornborough0@theatlantic.com\",\n  \"gender\": \"Male\",\n  \"credit_card_type\": \"visa\",\n  \"credit_card_number\": \"3562444175055197\",\n  \"user_group\": \"premium\"\n}"},"doActionLogs":[]}]},"_logStatus":"ok"},"startTime":1582806545151,"status":"SUCCESS"}</script>
      <div>
        <h2>Payment providers</h2>
        <ul>
          <li>
            <p>Payment provider: PayPal premium</p>
            <p>Payment URL: https://paypal-example.com/payment?id=1983247919hv9sa398f</p>
          </li>
          <li>
            <p>Payment provider: PayU</p>
            <p>Payment URL: https://payu-example.com/tr?id=afj08aw398gha0we9ge</p>
          </li>
          <li>
            <p>Payment provider: Credit Card</p>
            <p>Payment URL: https://cc-example.com/pay/19g8esry9se8rgyse90r8ug4</p>
          </li>
        </ul>
      </div>
      <!-- data-knotx-id="c19f4c38-00e8-44f0-a014-39f88ef3afd7" -->
    </div>
  </div>
</div>
</body>
</html>