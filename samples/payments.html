<!--
  Copyright (C) 2019 Knot.x Project

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Knot.x Functional Test: Payments</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="http://cognifide.com/favicon.ico?v=2"/>
  <link href="https://bootswatch.com/4/simplex/bootstrap.min.css" rel="stylesheet"/>
</head>
<body>
<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <div class="jumbotron">
        <h2>
          Hello Knot.x - a reactive integration framework!
        </h2>
        <p>
          This page combines dynamic data with a template. A template may consist of many
          independent
          fragments defining the data they require. Dynamic data may come from external web APIs,
          databases etc.
        </p>
        <p>
          <a class="btn btn-primary btn-large"
             href="https://github.com/Knotx/knotx">Learn more</a>
        </p>
      </div>
    </div>
  </div>
  <div class="row" style="margin-left: 10px">
    <!-- data-knotx-id="11f06e78-bbdb-43f5-80cd-e0e20982f1ee" --><script data-knotx-debug="log" data-knotx-id="11f06e78-bbdb-43f5-80cd-e0e20982f1ee" type="application/json">{"finishTime":1583746302396,"fragment":{"id":"11f06e78-bbdb-43f5-80cd-e0e20982f1ee","type":"snippet"},"graph":{"id":"d7502b45-1f11-43cc-a288-39f3792bffcf","type":"SINGLE","label":"fetch-user-info","subtasks":[],"operation":{"data":{"alias":"fetch-user-info","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/userInfo.json","port":57344},"logLevel":"info"}},"factory":"action"},"on":{"_success":{"id":"223f7ec1-3a0d-4500-8cd8-5480e0387c5d","type":"SINGLE","label":"te-hbs","subtasks":[],"operation":{"data":{"alias":"te-hbs","actionFactory":"knot","actionConfig":{"address":"knotx.knot.te.handlebars","deliveryOptions":{"sendTimeout":3000},"logLevel":"info"}},"factory":"action"},"on":{},"status":"SUCCESS","response":{"transition":"_success","invocations":[]}}},"status":"SUCCESS","response":{"transition":"_success","invocations":[{"alias":"fetch-user-info","logs":{"request":{"path":"/service/mock/userInfo.json","requestHeaders":{}},"response":{"httpVersion":"HTTP_1_1","statusCode":"200","statusMessage":"OK","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:57344/service/mock/userInfo.json"},"responseBody":"{\n  \"id\": 3214232,\n  \"first_name\": \"Redford\",\n  \"last_name\": \"Cornborough\",\n  \"email\": \"rcornborough0@theatlantic.com\",\n  \"gender\": \"Male\",\n  \"credit_card_type\": \"visa\",\n  \"credit_card_number\": \"3562444175055197\",\n  \"user_group\": \"premium\"\n}"},"doActionLogs":[]}]}},"startTime":1583746302013,"status":"SUCCESS"}</script>
      <div>
        <h2>User details</h2>
        <p>Id: 3214232</p>
        <p>Name: Redford</p>
        <p>Surname: Cornborough</p>
        <p>Email: rcornborough0@theatlantic.com</p>
      </div>
    <!-- data-knotx-id="11f06e78-bbdb-43f5-80cd-e0e20982f1ee" -->
  </div>
  <div class="row">
    <div class="row" style="margin-left: 10px">
      <!-- data-knotx-id="64baf620-cd37-41b5-afa3-dad7ed4cf437" --><script data-knotx-debug="log" data-knotx-id="64baf620-cd37-41b5-afa3-dad7ed4cf437" type="application/json">{"finishTime":1583746302446,"fragment":{"id":"64baf620-cd37-41b5-afa3-dad7ed4cf437","type":"snippet"},"graph":{"id":"a2818495-a6fa-4e93-89f7-7d1500142eba","type":"SINGLE","label":"fetch-user-info","subtasks":[],"operation":{"data":{"alias":"fetch-user-info","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/userInfo.json","port":57344},"logLevel":"info"}},"factory":"action"},"on":{"_success":{"id":"a0f828d0-f0ba-4e52-b362-d616ff970113","type":"COMPOSITE","label":"composite","subtasks":[{"id":"4f90029d-0c42-401c-8e51-02c13d589ce2","type":"SINGLE","label":"fetch-payment-providers","subtasks":[],"operation":{"data":{"alias":"fetch-payment-providers","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/paymentProviders.json","port":57344},"logLevel":"info"}},"factory":"action"},"on":{"_error":{"id":"b211e470-94db-47bd-8d1f-16d0d20216c4","type":"SINGLE","label":"fetch-payment-providers-fallback","subtasks":[],"operation":{"data":{"alias":"fetch-payment-providers-fallback","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":57344},"logLevel":"info"}},"factory":"action"},"on":{},"status":"UNPROCESSED"}},"status":"SUCCESS","response":{"transition":"_success","invocations":[{"alias":"fetch-payment-providers","logs":{"request":{"path":"/service/mock/paymentProviders.json","requestHeaders":{}},"response":{"httpVersion":"HTTP_1_1","statusCode":"200","statusMessage":"OK","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:57344/service/mock/paymentProviders.json"},"responseBody":"[\n  {\n    \"verified\": true,\n    \"paymentUrl\": \"https://paypal-example.com/payment?id=1983247919hv9sa398f\",\n    \"name\": \"PayPal premium\"\n  },\n  {\n    \"verified\": true,\n    \"paymentUrl\": \"https://payu-example.com/tr?id=afj08aw398gha0we9ge\",\n    \"name\": \"PayU\"\n  },\n  {\n    \"verified\": true,\n    \"paymentUrl\": \"https://cc-example.com/pay/19g8esry9se8rgyse90r8ug4\",\n    \"name\": \"Credit Card\"\n  }\n]"},"doActionLogs":[]}]}},{"id":"e062aab4-99ad-4ed7-baf8-5fd0bb081873","type":"SINGLE","label":"fetch-offers","subtasks":[],"operation":{"data":{"alias":"fetch-offers","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/specialOffers.xml","port":57344},"responseOptions":{"forceJson":true,"predicates":[]},"logLevel":"info"}},"factory":"action"},"on":{"_error":{"id":"d845abd9-faa5-4046-b295-0aadf0147b80","type":"SINGLE","label":"fetch-offers-fallback","subtasks":[],"operation":{"data":{"alias":"fetch-offers-fallback","actionFactory":"inline-payload","actionConfig":{"alias":"fetch-offers","payload":{"_result":{"fallback":"json-syntax-error"}},"logLevel":"info"}},"factory":"action"},"on":{},"status":"SUCCESS","response":{"transition":"_success","invocations":[{"alias":"fetch-offers-fallback","logs":{"key":"fetch-offers","value":{"_result":{"fallback":"json-syntax-error"}}},"doActionLogs":[]}]}}},"status":"ERROR","response":{"transition":"_error","invocations":[{"alias":"fetch-offers","logs":{"request":{"path":"/service/mock/specialOffers.xml","requestHeaders":{}},"response":{"httpVersion":"HTTP_1_1","statusCode":"500","statusMessage":"Server Error","headers":{"Content-Type":["text/html; charset=ISO-8859-1"],"Cache-Control":["must-revalidate,no-cache,no-store"],"Content-Length":["2643"],"Connection":["close"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:57344/service/mock/specialOffers.xml"},"errors":[{"className":"java.io.IOException","message":"The service responded with unsuccessful status code: 500"}]},"doActionLogs":[]}]}},{"id":"54d7ea4f-8ccd-403b-aaf1-cc0ca4dd161e","type":"SINGLE","label":"fetch-delivery-options-cb","subtasks":[],"operation":{"data":{"alias":"fetch-delivery-options-cb","actionFactory":"cb","actionConfig":{"circuitBreakerName":"delivery-cb","circuitBreakerOptions":{"maxRetries":1,"timeout":50},"logLevel":"info"}},"factory":"action"},"on":{"_fallback":{"id":"fb21957e-311f-4720-938e-7021f36bd055","type":"SINGLE","label":"fetch-delivery-timeout","subtasks":[],"operation":{"data":{"alias":"fetch-delivery-timeout","actionFactory":"inline-payload","actionConfig":{"alias":"fetch-delivery","payload":{"_result":{"fallback":"action ended with _timeout"}},"logLevel":"info"}},"factory":"action"},"on":{},"status":"SUCCESS","response":{"transition":"_success","invocations":[{"alias":"fetch-delivery-timeout","logs":{"key":"fetch-delivery","value":{"_result":{"fallback":"action ended with _timeout"}}},"doActionLogs":[]}]}}},"status":"OTHER","response":{"transition":"_fallback","invocations":[{"alias":"fetch-delivery-options-cb","logs":{"invocationCount":"2","error":"Exception: class io.vertx.circuitbreaker.TimeoutException. operation timeout"},"doActionLogs":[]}]}}],"operation":{"factory":"subtasks"},"on":{"_success":{"id":"ad9186ad-a81d-49cd-928f-136ea9028c08","type":"SINGLE","label":"te-pebble","subtasks":[],"operation":{"data":{"alias":"te-pebble","actionFactory":"knot","actionConfig":{"address":"knotx.knot.te.pebble","deliveryOptions":{"sendTimeout":3000},"logLevel":"info"}},"factory":"action"},"on":{},"status":"SUCCESS","response":{"transition":"_success","invocations":[]}}},"status":"SUCCESS","response":{"transition":"_success","invocations":[]}},"_custom":{"id":"e82dcc94-ef8a-4301-bf7e-8963119882c9","type":"SINGLE","label":"fetch-user-info-custom-fallback","subtasks":[],"operation":{"data":{"alias":"fetch-user-info-custom-fallback","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":57344},"logLevel":"info"}},"factory":"action"},"on":{},"status":"UNPROCESSED"},"_error":{"id":"d45a1bfc-91fb-428f-aa95-2620bc01422d","type":"SINGLE","label":"fetch-user-info-fallback","subtasks":[],"operation":{"data":{"alias":"fetch-user-info-fallback","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":57344},"logLevel":"info"}},"factory":"action"},"on":{"_success":{"id":"6b91601a-4120-4d32-a86e-33ac08571720","type":"SINGLE","label":"fetch-user-info-fallback-success","subtasks":[],"operation":{"data":{"alias":"fetch-user-info-fallback-success","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":57344},"logLevel":"info"}},"factory":"action"},"on":{},"status":"UNPROCESSED"},"_error":{"id":"561f3d47-ab2f-4cff-bd0c-36f5b1f36077","type":"SINGLE","label":"fetch-user-info-fallback-error","subtasks":[],"operation":{"data":{"alias":"fetch-user-info-fallback-error","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":57344},"logLevel":"info"}},"factory":"action"},"on":{},"status":"UNPROCESSED"}},"status":"UNPROCESSED"}},"status":"SUCCESS","response":{"transition":"_success","invocations":[{"alias":"fetch-user-info","logs":{"request":{"path":"/service/mock/userInfo.json","requestHeaders":{}},"response":{"httpVersion":"HTTP_1_1","statusCode":"200","statusMessage":"OK","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:57344/service/mock/userInfo.json"},"responseBody":"{\n  \"id\": 3214232,\n  \"first_name\": \"Redford\",\n  \"last_name\": \"Cornborough\",\n  \"email\": \"rcornborough0@theatlantic.com\",\n  \"gender\": \"Male\",\n  \"credit_card_type\": \"visa\",\n  \"credit_card_number\": \"3562444175055197\",\n  \"user_group\": \"premium\"\n}"},"doActionLogs":[]}]}},"startTime":1583746302018,"status":"SUCCESS"}</script>
        <div>
          <h2>Payment providers</h2>
          <ul>
                        <li>
              <p>Payment provider: PayPal premium</p>
              <p>Payment URL: https://paypal-example.com/payment?id=1983247919hv9sa398f</p>
            </li>
                        <li>
              <p>Payment provider: PayU</p>
              <p>Payment URL: https://payu-example.com/tr?id=afj08aw398gha0we9ge</p>
            </li>
                        <li>
              <p>Payment provider: Credit Card</p>
              <p>Payment URL: https://cc-example.com/pay/19g8esry9se8rgyse90r8ug4</p>
            </li>
                      </ul>
        </div>
      <!-- data-knotx-id="64baf620-cd37-41b5-afa3-dad7ed4cf437" -->
    </div>
  </div>
</div>
</body>
</html>